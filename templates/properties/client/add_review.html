{% extends "properties/base.html" %}
{% load static %}
{% block title %}Write a Review{% endblock %}

{% block style %}
<link href="{% static 'properties/main_css/bootstrap.min.css' %}" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="{% static 'properties/main_css/style.css' %}" />

<style>
/* --- Star Rating Styling --- */

</style>
{% endblock %}

{% block body %}
<div class="review-card">
  <h2>Write a Review</h2>

  <form method="post" action="{%url 'add_review' property.id %}">
    {% csrf_token %}
<!-- Attach property_id if available -->
    {% if property %}
  <input type="hidden" name="property_id" value="{{ property.id }}">
{% endif %}


    <!-- User Email -->
    <div class="mb-3">
      <label class="form-label">Email</label>
      <input type="email" name="email" class="form-control" value="{{ user.email }}" required>
    </div>

    <!-- User Role -->
    <div class="mb-3">
      <label class="form-label">You are?</label>
      <input type="text" name="role" class="form-control" value="{{ user.profile.role }}" required>
    </div>

    <!-- Locality Search -->
    <!-- City -->
<div class="mb-3 position-relative">
  <label class="form-label">City</label>
  <input type="text" id="cityInput" name="city_name" class="form-control"
         placeholder="Type city..." autocomplete="off" required>
  <ul id="citySuggestions" class="list-group position-absolute w-100"></ul>
</div>

<!-- Locality -->
<div class="mb-3 position-relative">
  <label class="form-label">Locality</label>
  <input type="text" id="localityInput" name="locality_name" class="form-control"
         placeholder="Type locality..." autocomplete="off" required>
  <ul id="localitySuggestions" class="list-group position-absolute w-100"></ul>
</div>


    <!-- Ratings -->
    {% for field, label in fields %}
    <div class="mb-3 d-flex align-items-center">
      <label class="form-label mb-0">{{ label }}</label>
      <div class="star-rating">
        {% for i in "54321" %}
          <input type="radio" id="{{ field }}{{ i }}" name="{{ field }}" value="{{ i }}" required>
          <label for="{{ field }}{{ i }}">â˜…</label>
        {% endfor %}
      </div>
    </div>
    {% endfor %}

    <!-- Years Lived -->
    <div class="mb-3">
      <label class="form-label">Years you lived in this locality</label>
      <input type="number" name="years_lived" class="form-control" min="0" required>
    </div>

    <!-- Comment -->
    <div class="mb-3">
      <label class="form-label">Your Comment</label>
      <textarea name="comment" class="form-control" rows="4" placeholder="Write your experience..."></textarea>
    </div>

    <button type="submit" class="btn btn-primary w-100">Submit Review</button>
  </form>
</div>
{% endblock %}

{% block js %}
<script src="{% static 'properties/main_js/main.js' %}"></script>
{% endblock %}
